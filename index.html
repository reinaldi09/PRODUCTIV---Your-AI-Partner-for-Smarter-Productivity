<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI Productivity Dashboard - Clean & Minimalist v2</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <!-- Tailwind CSS CDN - For production, consider using a build process with npm/yarn -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://unpkg.com/feather-icons"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }

    /* Checkbox Animation Styles */
    .checkbox-container {
      transition: all 0.2s ease;
    }

    .checkbox-container:hover {
      transform: scale(1.05);
    }

    .checkbox-container.clicked {
      animation: checkboxBounce 0.4s ease;
    }

    .custom-checkbox {
      transition: all 0.3s ease;
    }

    .custom-checkbox.checked {
      background: #10B981 !important;
      border-color: #10B981 !important;
      transform: scale(1.1);
      animation: checkPulse 0.3s ease;
    }

    .checkmark-icon {
      opacity: 0;
      transform: scale(0) rotate(-45deg);
      transition: all 0.3s ease;
    }

    .checkmark-icon.visible {
      opacity: 1;
      transform: scale(1) rotate(0deg);
    }

    @keyframes checkboxBounce {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }

    @keyframes checkPulse {
      0% { transform: scale(1.1); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1.1); }
    }

    /* Task completion animation */
    .task-completing {
      animation: taskComplete 0.5s ease-out;
    }

    @keyframes taskComplete {
      0% { opacity: 1; transform: translateX(0); }
      50% { opacity: 0.8; transform: translateX(10px); }
      100% { opacity: 0; transform: translateX(20px); }
    }

    /* Completed task highlight animation */
    .task-new-completed {
      animation: newCompleted 0.6s ease-out;
    }

    @keyframes newCompleted {
      0% { opacity: 0; transform: translateY(-10px); }
      100% { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">
  <div class="max-w-6xl mx-auto p-6">
    <header class="flex items-center justify-between gap-6 mb-8 p-6 bg-white rounded-lg shadow-sm border">
      <div class="flex items-center gap-6">
        <div class="w-16 h-16 bg-blue-500 rounded-lg flex items-center justify-center text-white font-semibold text-lg">
          <!-- <i data-feather="cpu" class="w-6 h-6"></i> -->
          <img src="assets/productiv-logo.png" alt="PRODUCTIV Logo" class="w-16 h-16 object-contain" />
        </div>
        <div>
          <div class="text-2xl font-semibold text-gray-800">Productivity Dashboard</div>
        </div>
      </div>
      <div class="flex gap-3 items-center">
        <button class="btn-refresh px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700 font-medium transition-colors">
          <i data-feather="refresh-cw" class="w-4 h-4 inline mr-2"></i>REFRESH
        </button>
        <button class="btn-toggle-auto-refresh px-4 py-2 bg-green-100 hover:bg-green-200 rounded-lg text-green-700 font-medium transition-colors">
          <i data-feather="play" class="w-4 h-4 inline mr-2"></i>AUTO REFRESH: ON
        </button>
        <div class="flex items-center gap-2">
          <span class="text-sm text-gray-600">Interval:</span>
          <select id="refreshInterval" class="px-2 py-1 border border-gray-300 rounded text-sm">
            <option value="30000">30s</option>
            <option value="60000" selected>1m</option>
            <option value="120000">2m</option>
            <option value="300000">5m</option>
          </select>
        </div>
        <div class="flex items-center gap-2">
          <div id="autoRefreshIndicator" class="w-2 h-2 bg-green-500 rounded-full animate-pulse hidden"></div>
          <span id="lastRefreshTime" class="text-xs text-gray-500">Last updated: --:--:--</span>
        </div>
        <a class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium transition-colors" href="#">
          <i data-feather="file-text" class="w-4 h-4 inline mr-2"></i>API DOCS
        </a>
        <a href="/logout" class="btn-logout px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg font-medium transition-colors inline-block">
          <i data-feather="log-out" class="w-4 h-4 inline mr-2"></i>LOGOUT
        </a>
      </div>
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- LEFT -->
      <div class="lg:col-span-2 space-y-6">
        <!-- Main Goals -->
        <section class="bg-white rounded-lg shadow-sm border p-6">
          <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
            <i data-feather="target" class="w-5 h-5 text-purple-500 mr-2"></i>
            MAIN GOALS
          </h3>
          <div id="goalsList" class="space-y-4"></div>
          <div id="goalsEmpty" class="text-gray-500 text-center py-8 hidden">No goals set</div>
        </section>

        <!-- Overdue Tasks -->
        <section class="bg-white rounded-lg shadow-sm border p-6">
          <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
            <i data-feather="alert-triangle" class="w-5 h-5 text-red-500 mr-2"></i>
            OVERDUE TASKS
          </h3>
          <div id="overdueList" class="space-y-3"></div>
          <div id="overdueEmpty" class="text-gray-500 text-center py-8 hidden">No overdue tasks</div>
        </section>

        <!-- Priority Tasks -->
        <section class="bg-white rounded-lg shadow-sm border p-6">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-gray-800">PRIORITY TASKS</h3>
            <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium" id="todayTag">
              TODAY: <span id="todayStr">-</span>
            </span>
          </div>
          <div id="priorityList" class="space-y-3"></div>
          <div id="priorityEmpty" class="text-gray-500 text-center py-8 hidden">No priority tasks</div>
        </section>

        <!-- Reminder -->
        <section class="bg-white rounded-lg shadow-sm border p-6">
          <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
            <i data-feather="bell" class="w-5 h-5 text-yellow-500 mr-2"></i>
            REMINDER
          </h3>
          <div id="reminderList" class="space-y-3"></div>
          <div id="reminderEmpty" class="text-gray-500 text-center py-8 hidden">No upcoming tasks</div>
        </section>

        <!-- Progress Charts -->
        <section class="bg-white rounded-lg shadow-sm border p-6">
          <h3 class="text-lg font-semibold text-gray-800 mb-6 flex items-center">
            <i data-feather="bar-chart-2" class="w-5 h-5 text-green-500 mr-2"></i>
            PROGRESS
          </h3>
          <div class="flex justify-center">
            <!-- Overall Tasks Chart -->
            <div class="text-center">
              <h4 class="text-sm font-medium text-gray-700 mb-4">OVERALL TASKS</h4>
              <div class="w-48 h-48 mx-auto">
                <canvas id="overallChart"></canvas>
              </div>
              <div class="flex justify-center gap-4 mt-4">
                <span class="flex items-center text-sm text-gray-600">
                  <div class="w-3 h-3 bg-green-500 rounded mr-2"></div>DONE
                </span>
                <span class="flex items-center text-sm text-gray-600">
                  <div class="w-3 h-3 bg-red-500 rounded mr-2"></div>PENDING
                </span>
              </div>
              <div class="text-gray-600 text-sm mt-2" id="overallText">-</div>
            </div>

          </div>
        </section>

        <!-- Recent Completed Tasks -->
        <section class="bg-white rounded-lg shadow-sm border p-6">
          <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
            <i data-feather="check-circle" class="w-5 h-5 text-green-500 mr-2"></i>
            RECENT COMPLETED
          </h3>
          <div id="completedList" class="space-y-3"></div>
          <div id="completedEmpty" class="text-gray-500 text-center py-8 hidden">No completed tasks</div>
        </section>
      </div>

      <!-- RIGHT -->
      <div class="space-y-6">
        <!-- Profile & Tips -->
        <section class="bg-white rounded-lg shadow-sm border p-6">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-gray-800 flex items-center">
              <i data-feather="user" class="w-5 h-5 text-blue-500 mr-2"></i>
              PROFILE & TIPS
            </h3>
            <button class="px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded text-sm font-medium transition-colors edit-profile-btn">
              <i data-feather="edit-2" class="w-4 h-4"></i>
            </button>
          </div>
          <div class="flex flex-wrap gap-3 mb-4">
            <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium" id="userCategoryPill">JOB: -</span>
            <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium" id="userStatusPill">STATUS: -</span>
            <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-medium" id="userSlotsPill">SLOTS: -</span>
          </div>
          <div class="mb-4">
            <div class="text-gray-700 italic border-l-4 border-blue-500 pl-4" id="quoteText">"â€”"</div>
          </div>
          <hr class="my-4">
          <div class="space-y-3">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">MENTAL PROBLEM</label>
              <div class="text-gray-600" id="mhProblem">â€”</div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">SOLUTION</label>
              <div class="text-gray-600" id="mhSolution">â€”</div>
            </div>
          </div>
        </section>

        <!-- Add New Task -->
        <section class="bg-white rounded-lg shadow-sm border p-6">
          <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
            <i data-feather="plus" class="w-5 h-5 text-green-500 mr-2"></i>
            ADD NEW TASK
          </h3>
          <form id="taskForm" class="space-y-4">
            <input type="hidden" name="task_id" />
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">TASK NAME</label>
              <input class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" name="task_name" placeholder="Example: Send 3 proposals to Upwork" required />
            </div>
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">DUE DATE</label>
                <input class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" type="date" name="due_date" />
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">CATEGORY</label>
                <select name="category" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                  <option value="Priority">PRIORITY</option>
                  <option value="Other">OTHER</option>
                </select>
              </div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">REASONING</label>
              <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" name="reasoning" rows="3" placeholder="Directly leads to financial goal, high urgency, low effort."></textarea>
            </div>
            <div class="flex justify-end gap-3">
              <button type="button" class="px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg font-medium transition-colors" id="aiSuggestBtn">
                        <i data-feather="star" class="w-4 h-4 inline mr-2"></i>USE AI
                      </button>
              <button class="px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg font-medium transition-colors" type="submit">
                <i data-feather="plus" class="w-4 h-4 inline mr-2"></i>ADD TASK
              </button>
            </div>
          </form>
        </section>

        <!-- Feedback -->
        <section class="bg-white rounded-lg shadow-sm border p-6">
          <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
            <i data-feather="message-square" class="w-5 h-5 text-orange-500 mr-2"></i>
            FEEDBACK TO AI
          </h3>
          <form id="feedbackForm" class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">FEEDBACK</label>
              <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" name="feedback" rows="3" placeholder="Example: AI too often puts exercise in priority."></textarea>
            </div>
            <div class="flex justify-end">
              <button class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium transition-colors" type="submit">
                <i data-feather="send" class="w-4 h-4 inline mr-2"></i>SEND FEEDBACK
              </button>
            </div>
          </form>
        </section>

      </div>
    </div>

    <footer class="flex items-center justify-between mt-8 p-4 bg-white rounded-lg shadow-sm border text-gray-600">
      <div>&copy; <span id="year"></span> AI PRODUCTIVITY</div>
      <div>BACKEND: N8N + GOOGLE SHEETS</div>
    </footer>
  </div>

  <div id="toast" class="fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg opacity-0 transition-opacity duration-300">
    SAVED
  </div>

  <!-- AI Input Modal -->
  <div id="aiModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 pointer-events-none transition-opacity duration-300">
    <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-800 flex items-center">
          <i data-feather="star" class="w-5 h-5 text-purple-500 mr-2"></i>
          AI TASK GENERATOR
        </h3>
        <button class="text-gray-400 hover:text-gray-600" id="closeAiModal">
          <i data-feather="x" class="w-6 h-6"></i>
        </button>
      </div>
      <form id="aiForm" class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">ENTER TASK DESCRIPTION</label>
          <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" name="rawInput" rows="6" placeholder="Example: I need to create a proposal for a tech startup client. Deadline next week. This is important because the value is huge and could become a long-term client. Need to research their competitors first."></textarea>
        </div>
        <div class="flex justify-end">
          <button type="submit" class="px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg font-medium transition-colors">
            <i data-feather="zap" class="w-4 h-4 inline mr-2"></i>GENERATE WITH AI
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Date Extension Modal -->
  <div id="dateModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 pointer-events-none transition-opacity duration-300">
    <div class="bg-white rounded-lg p-6 w-full max-w-sm mx-4">
      <div class="flex items-center justify-between mb-4">
        <h4 class="text-lg font-semibold text-gray-800 flex items-center">
          <i data-feather="calendar" class="w-5 h-5 text-blue-500 mr-2"></i>
          EXTEND DUE DATE
        </h4>
        <button class="text-gray-400 hover:text-gray-600" id="closeDateModal">
          <i data-feather="x" class="w-6 h-6"></i>
        </button>
      </div>
      <form id="dateForm" class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">NEW DATE</label>
          <input class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" type="date" name="newDueDate" required />
        </div>
        <div class="flex justify-end gap-3">
          <button type="button" class="px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-lg font-medium transition-colors" id="cancelDateBtn">CANCEL</button>
          <button type="submit" class="px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg font-medium transition-colors">SAVE</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Goal Edit Modal -->
  <div id="goalModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 pointer-events-none transition-opacity duration-300">
    <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
      <div class="flex items-center justify-between mb-4">
        <h4 class="text-lg font-semibold text-gray-800 flex items-center">
          <i data-feather="edit-2" class="w-5 h-5 text-blue-500 mr-2"></i>
          EDIT GOAL
        </h4>
        <button class="text-gray-400 hover:text-gray-600" id="closeGoalModal">
          <i data-feather="x" class="w-6 h-6"></i>
        </button>
      </div>
      <form id="goalForm" class="space-y-4">
        <input type="hidden" name="goalId" id="goalId" />
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">GOAL TITLE</label>
          <input class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" type="text" name="goalTitle" required />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">DESCRIPTION</label>
          <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" name="goalDescription" rows="3" required></textarea>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">PROGRESS (%)</label>
            <input class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" type="number" name="goalProgress" min="0" max="100" required />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">STATUS</label>
            <select name="goalStatus" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
              <option value="in_progress">IN PROGRESS</option>
              <option value="completed">COMPLETED</option>
              <option value="not_started">NOT STARTED</option>
            </select>
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">TARGET DATE</label>
          <input class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" type="date" name="goalTargetDate" />
        </div>
        <div class="flex justify-end gap-3">
          <button type="button" class="px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-lg font-medium transition-colors" id="cancelGoalBtn">CANCEL</button>
          <button type="submit" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium transition-colors">UPDATE GOAL</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Profile Edit Modal -->
  <div id="profileModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 pointer-events-none transition-opacity duration-300">
    <div class="bg-white rounded-lg p-6 w-full max-w-sm mx-4">
      <div class="flex items-center justify-between mb-4">
        <h4 class="text-lg font-semibold text-gray-800 flex items-center">
          <i data-feather="edit-2" class="w-5 h-5 text-blue-500 mr-2"></i>
          EDIT PROFILE
        </h4>
        <button class="text-gray-400 hover:text-gray-600" id="closeProfileModal">
          <i data-feather="x" class="w-6 h-6"></i>
        </button>
      </div>
      <form id="profileForm" class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">JOB/PROFESSION</label>
          <input type="text" name="userJob" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="e.g., Software Engineer, Student, Entrepreneur" />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">PERSONAL STATUS</label>
          <input type="text" name="userStatus" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="e.g., Single, Married, Student" />
        </div>
        <div class="flex justify-end gap-3">
          <button type="button" class="px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-lg font-medium transition-colors" id="cancelProfileBtn">CANCEL</button>
          <button type="submit" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium transition-colors">UPDATE PROFILE</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Load all JavaScript modules -->
  <script src="config.js"></script>
  <script src="utils.js"></script>
  <script src="data-fetchers.js"></script>
  <script src="renderers.js"></script>
  <script src="main.js"></script>
  <script src="handlers.js"></script>

  <!-- Initialize the application -->
  <script>
    // Initialize Feather icons
    feather.replace();

    // Initialize the application
    document.getElementById('year').textContent = new Date().getFullYear();

    setTimeout(() => {
      if (typeof Chart === 'undefined') {
        console.error('Chart.js failed to load from CDN');
      }
    }, 1000);

    // Initialize auto-refresh system
    loadAll().then(() => {
      updateRefreshButton();
      startAutoRefresh();
      console.log('ðŸš€ Dashboard initialized with auto-refresh enabled');
    });
  </script>
</body>
</html>